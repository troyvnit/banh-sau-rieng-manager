<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>
    <!---Kendo CSS--->
    <link href="@Url.Content("~/kendo/content/shared/styles/examples-offline.css")" rel="stylesheet" />
    <link href="@Url.Content("~/kendo/styles/kendo.common.min.css")" rel="stylesheet" />
    <link href="@Url.Content("~/kendo/styles/kendo.metro.min.css")" rel="stylesheet" type="text/css" />
    @*<link href="@Url.Content("~/kendo/styles/kendo.default.min.css")" rel="stylesheet" type="text/css" />*@
    <!---End of Kendo CSS--->
    <!---Kendo JS--->
    <script src="@Url.Content("~/kendo/js/jquery.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/kendo/js/kendo.web.min.js")" type="text/javascript"></script>
    @*<script src="../../Scripts/Troy/jquery.tools.min.js" type="text/javascript"></script>*@
    <!---ENd of Kendo CSS--->
<script src="@Url.Content("~/Scripts/jquery.shortcuts.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.printElement.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.webcam.js")" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#menu").kendoMenu();
            var pos = 0, ctx = null, saveCB, image = [];
            var canvas = document.createElement('canvas');
            canvas.setAttribute('width', 320);
            canvas.setAttribute('height', 240);
            ctx = canvas.getContext('2d');
            image = ctx.getImageData(0, 0, 320, 240);

            var saveCB = function (data) {
                var col = data.split(';');
                var img = image;
                for (var i = 0; i < 320; i++) {
                    var tmp = parseInt(col[i]);
                    img.data[pos + 0] = (tmp >> 16) & 0xff;
                    img.data[pos + 1] = (tmp >> 8) & 0xff;
                    img.data[pos + 2] = tmp & 0xff;
                    img.data[pos + 3] = 0xff;
                    pos += 4;
                }

                if (pos >= 4 * 320 * 240) {
                    ctx.putImageData(img, 0, 0);
                    $.post('@Url.Action("Upload","Account")', { type: 'data', image: canvas.toDataURL("image/png") }, function (result) {
                        if (result.success) {
                            alert('Chấm công thành công ^^!');
                        }
                    });
                    pos = 0;
                }
            };

            $('#webcam').webcam({
                width: 240,
                height: 160,
                mode: 'callback',
                swffile: '@Url.Content("~/scripts/jscam_canvas_only.swf")',
                onSave: saveCB,
                onCapture: function () {
                    webcam.save();
                }
            });
            $("#attendance").click(function () {
                webcam.capture();
            });
        });    //ini menu
    </script>
</head>
<body>
    <ul id="menu">
        <li style="float: left"><input type="button" class="k-button" id="attendance" value="Chấm công"/></li>
        @{if (Request.IsAuthenticated && Session["UserBANHSAURIENG"] != null)
          {
            <li style="float: right"><a href="@Url.Action("LogOff", "Account")">Log Out</a></li> <li
                style="float: right">Welcome @User.Identity.Name</li> 
          }
          else
          {
            <li style="float: right"><a href="@Url.Action("Login", "Account")">Log In</a></li>
          }
        }
    </ul>
    <div id="horizontal" style="min-height:600px">
        <div id="left-pane">
           <div id="webcam"></div>
           <ul id="panelbar">
                <li><a href="@Url.Action("Index1","Sale")">Bán hàng</a></li>
                <li><a href="@Url.Action("Index","Product")">Sản phẩm</a></li>
                <li><a href="@Url.Action("Index","Combo")">Combo</a></li>
                <li><a>Nhân viên</a></li>
            </ul>
        </div>
        <div id="center-pane">
            @RenderBody()
        </div>
    </div>
</body>
<footer>
<!-- DOCK -->
</footer>
</html>
@RenderSection("Scripts", required: false)
<script type="text/javascript">
    $(document).ready(function () {
        $("#horizontal").kendoSplitter({
            panes: [
                            { collapsible: true, size: "240px" },
                            { collapsible: false }
                        ]
        });
        $("#panelbar").kendoPanelBar({
            expandMode: "single"
        });
    })
</script>